/*
*  Video Lecture: 39
*  Instructor: Arif Butt
*  Course: System Programming with Linux
*  hackplanetearth.c: The shell code prints a message on screen and exits
*  compile: gcc hackplanetearch.c
*  usage: ./a.out 
*/
#include <stdio.h>
#include <string.h>

char *code = "\xeb\x1e\x5e\x48\x31\xc0\xb0\x01\x48\x89\xc7\x48\x89\xfa\x48\x83\xc2\x28\x0f\x05\x48\x31\xc0\x48\x83\xc0\x3c\x48\x31\xff\x0f\x05\xe8\xdd\xff\xff\xff\x4c\x65\x74\x20\x75\x73\x20\x48\x61\x63\x6b\x20\x50\x6c\x61\x6e\x65\x74\x20\x45\x61\x72\x74\x68\x20\x77\x69\x74\x68\x20\x41\x72\x69\x66\x20\x42\x75\x74\x74\x0a";

int main(){
   printf("Length of Shellcode is %d bytes\n", strlen(code));
   int (*foo)() = (int(*)())code;
   foo();
   return 0;
}
